package zcq.myjpa.examples.impl;

import com.alibaba.fastjson.JSON;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import zcq.myjpa.vo.BankMessageVo;
import zcq.myjpa.examples.Example;
import zcq.myjpa.utils.FormatUtils;
import zcq.myjpa.utils.LoUtils;


/**
 * @author zhengchuqin
 * @version 1.0
 * @since 2019/09/05
 */
public class Example7 implements Example {
    private final static Logger logger = LoggerFactory.getLogger(Example7.class);

    public static void main(String[] args) {
        new Example7().doing1();
    }

    @Override
    public void doing1() {
        final String BANK_URL = "https://testpos.ebankunion.com:8443/nserver/service_pos";
        final String BANK_REQUEST_METHOD = "POST";
        String resMessage = "";
        //String message = "002C6000100000603200310000080000200000008000120000903535353535353532001100000000004000023031";
//        String message = "003B600010000060320031000008000020000000C000120000923535353535353532303030303030303030303230393834001100000000004000023031";
        //String message = "01986000100000FD00724F7418C64E7C5480A6F78D0ED9AF180F0A2035346234643131363562333534386130386265613136623535353863346138340B06303030353336100E59323031373130323042303030331106313030303031F0001D7B22746561636374223A2230393434303030303438393333383039227D6032003100000200702406C020C09A111662148377154173030000000000000000540107172708051000000006376214837715417303D27030E4AF0EB14B43CC003231313330303135303030303030303030303030353336313536CAF03FD81AC12E59261000000000000001609F2608B6975E4B2E641C559F2701809F101307010103A0A000010A010000000000814908159F3704AD972CA19F360201AE950580000400009A031807069C01009F02060000000000005F2A02015682027C009F1A0201569F03060000000000009F3303E048209F74009F34034203009F3501149F1E0841424344313233348408A0000003330101019F090200309F410400000004910071007200DF31009F63000014220000000006003939303346384334";
//        String message = "01746000100000FD00612DDF33656430EB4E3E595460768705E50A2038333363653439626466613534626665616230396532313337656638336634350B0630303035333610033130301106313030303031F000177B22746561636374223A2231373432303830323435227D6032003100000200702404C020C09A111962122620100336224620000000000000000140000172260300000006376212262010033622462DC9BA65FD1967CBA42035353535353535323030303030303030303030303336313135369A281854115738D4261000000000000001419F26009F27009F10009F37046B4779419F3602000D950500000000009A035112179C01009F02060000000000005F2A02084082027C009F1A0208409F03060000000000009F3303E048209F74009F34033F00009F3501149F1E0841424344313233348408A0000003330101019F090200309F4104000000009F91009F71009F7200DF3100DF3200DF3300DF34000014220000000006004132393544434636";
//        String message = "01886000000010FD006155D1D850FD9B1B22D9C408F8E3BCBD570A2033656666653937333732656534326361623334346162666635626335386533320B0630303033363110033130301106313030303031F000177B22746561636374223A2231323432303830323335227D6032003100000210703C06C022C09A10196212262010030432766F00000000000011944500022116280909182511051D00010006376212262010030432766DF19E9B4C0CF8139E2F39363535353535353532303030303030303030303030333631313536E7D25E8C42B631EA261000000000000001609F26088E0693D8F0C8F7A29F2701809F101307010103A0A000010A010000000000E066990E9F3704AC568C399F36020049950580000400009A031909189C01009F02060000000000005F2A02015682027C009F1A0201569F03060000000000009F3303E048209F74009F34030203009F3501149F1E0841424344313233348408A0000003330101019F090200309F410400000006910071007200DF31009F6300001422000000000600";
//        String message = "01746000100000FD00B948D1E4C2A65E9352EF240439CC2399BD0A2032653662656166373361623034343161613030616338343831313039343261620B063030303533361011535A424A323031393035323342303030321106313030303031F000617B22746561636374223A22303030303030303030303030303030377C303030303030303030303030303030397C303030303030303030303030303030347C303030303030303030303030303030317C30303030303030303030303030303033227D6032003100000200702404C020C09A111962122620100336224620000000000000000140000172260300000006376212262010033622462DC9BA65FD1967CBA42035353535353535323030303030303030303030303336313135369A281854115738D4261000000000000001419F26009F27009F10009F37046B4779419F3602000D950500000000009A035112179C01009F02060000000000005F2A02084082027C009F1A0208409F03060000000000009F3303E048209F74009F34033F00009F3501149F1E0841424344313233348408A0000003330101019F090200309F4104000000009F91009F71009F7200DF3100DF3200DF3300DF34000014220000000006004132393544434636";
//        String remessage = "01CB6000000010FD00B948D1E4C2A65E9352EF240439CC2399BD0A2032653662656166373361623034343161613030616338343831313039343261620B063030303533361011535A424A323031393035323342303030321106313030303031F000617B22746561636374223A22303030303030303030303030303030377C303030303030303030303030303030397C303030303030303030303030303030347C303030303030303030303030303030317C30303030303030303030303030303033227D6032003100000210703C04C022C09A10196212262010033622462F00000000000000014000017208452409182603000D0006376212262010033622462DC9BA65FD1967CBA42F393635353535353535323030303030303030303030303336313135369A281854115738D4261000000000000001419F26009F27009F10009F37046B4779419F3602000D950500000000009A035112179C01009F02060000000000005F2A02084082027C009F1A0208409F03060000000000009F3303E048209F74009F34033F00009F3501149F1E0841424344313233348408A0000003330101019F090200309F4104000000009F91009F71009F7200DF3100DF3200DF3300DF3400001422000000000600";
        String message = "018E6000000010FD00619D787133D255BDA91DB33585F83E3D140A2039663439623531623839646234636334616264383531613836353239363530350B0630303033363110033130301106313030303031F000177B22746561636374223A2231323432303830323335227D6032003100000210703C06C022C09A12196212262010030432766F00000000000011944500028616493010092511051D00010006376212262010030432766D71A21C692DFB4CF12F30393535353535353532303030303030303030303030333631313536E7D25E8C42B631EA261000000000000001609F26088E0693D8F0C8F7A29F2701809F101307010103A0A000010A010000000000E066990E9F3704AC568C399F36020049950580000400009A031909189C01009F02060000000000005F2A02015682027C009F1A0201569F03060000000000009F3303E048209F74009F34030203009F3501149F1E0841424344313233348408A0000003330101019F090200309F410400000006910071007200DF31009F630000142200000000060000046661696C";
        BankMessageVo bankMessageVo = new BankMessageVo(message, true);
        logger.info(FormatUtils.formatToJson(JSON.toJSONString(bankMessageVo)));
        try {
            resMessage = LoUtils.httpsRequest(BANK_URL, BANK_REQUEST_METHOD, message);
        } catch (Exception e) {
            e.printStackTrace();
        }
        System.out.println("total length:" + resMessage.length());
        System.out.println(resMessage);
        BankMessageVo reBankMessageVo = new BankMessageVo(resMessage, true);
        logger.info(FormatUtils.formatToJson(JSON.toJSONString(reBankMessageVo)));
        System.out.println("报文长度"+resMessage.substring(0, 4));
        System.out.println("TPDU"+resMessage.substring(4, 14));
        System.out.println("银联报文头"+resMessage.substring(14, 26));
        System.out.println("消息类型"+resMessage.substring(26, 30));
        System.out.println("位图"+resMessage.substring(30, 46));
        System.out.println("报文内容"+resMessage.substring(46));
    }

    @Override
    public void doing2() {
        final String s = FormatUtils.formatToJson("{\"bankHead\":\"603200310000\",\"bitMapVo\":{\"bitMap\":\"0111000000111100000001101100000000100010110000001001101000010010\",\"bitMapData\":{2:\"6212262010030432766\",3:\"000000\",35:\"6212262010030432766D7FB1E4144D1C80CE2\",4:\"000000119445\",39:\"09\",41:\"55555552\",42:\"000000000000361\",11:\"000307\",12:\"152254\",13:\"1010\",14:\"2511\",49:\"156\",52:\"E7D25E8C42B631EA\",53:\"2610000000000000\",22:\"051D\",23:\"0001\",55:\"9F26088E0693D8F0C8F7A29F2701809F101307010103A0A000010A010000000000E066990E9F3704AC568C399F36020049950580000400009A031909189C01009F02060000000000005F2A02015682027C009F1A0201569F03060000000000009F3303E048209F74009F34030203009F3501149F1E0841424344313233348408A0000003330101019F090200309F410400000006910071007200DF31009F6300\",25:\"00\",26:\"06\",60:\"22000000000600\",63:\"fail\"}},\"headerMapVo\":{\"businessCode\":\"000361\",\"code\":\"A23F4C27936E32673490790D2D0673CE\",\"length\":194,\"num\":\"e7395eec74574b76b63d2ffffbfaa0d8\",\"orderInfo\":\"{\\\"teacct\\\":\\\"1242080235\\\"}\",\"serialNum\":\"100\",\"type\":\"FD\",\"version\":\"100001\"},\"length\":796,\"msgtye\":\"0210\",\"tpdu\":\"6000000010\"}");
        System.out.println(s);
    }
}
